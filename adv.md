## 1. 背景

### 1.1. 丰富售卖形式

* 很多广告主不接受购买排期，乐意按量付费（类比分包传文件）

### 1.2. 增加竞争力度

* 增加平台议价能力

### 1.3. 未来接入广告联盟

* 广告商都支持实时竞价

## 2. 系统结构

### 2.1. 老系统

* 拓扑结构图

### 2.2. 新系统

* 拓扑结构图（新老之间的差异）

## 3. 高并发和高可用

* 有多大的并发量？

* 并发量压在谁身上？

* async http client > Netty为啥可靠

* dubbo 调优

### 3.2. 如何节省机器

* redis > local cache vs redis

### 3.3 如何保证高可用

* 网关尽量不参与业务逻辑，减少因为业务变化造成的网关发布

* 网关发布，先人工下节点

* dubbo设置合理超时时间+重试，确保发布不影响功能

* act 状态监控+down机现场快照

* onest 异常监控+性能监控

* nginx access log

* 各个机器硬件监控：网卡用量监控

* act 实时日志+kibana历史日志

* golang 关键接口巡检业务

* 平滑切量（流量爬坡半个月）

## 4. 分布式任务调度

* ej

* 跑批的设计思想

## 5. 经验总结

### 5.1. 先留好退路

* 接口容错：5xx、json接口返回html

* 过载保护

### 5.2. 降低用户感知度

* 兜底内容

* 替代方案


